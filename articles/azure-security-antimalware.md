<properties
   pageTitle="Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure | Microsoft Azure"
   description="Este artículo proporciona una introducción a la arquitectura de Microsoft Antimalware para Azure. Incluye los escenarios y las configuraciones admitidos para habilitar, configurar e implementar protección para Servicios en la nube y Máquinas virtuales de Azure. Trataremos las funciones básicas de configuración, administración y supervisión mediante las API de Administración de servicios de Microsoft Azure, los scripts de PowerShell, el Portal de administración de Azure y Visual Studio."
   services="virtual-machines, cloud-services, storage"
   documentationCenter="na"
   authors="YuriDio"
   manager="swadhwa"
   editor=""/>

<tags
   ms.service="azure-security"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="12/10/2015"
   ms.author="yuridio"/>

#Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure

El panorama moderno de amenazas para los entornos de nube es extraordinariamente dinámico, lo que aumenta la presión sobre los suscriptores de la nube de TI empresarial para mantener una protección eficaz a fin de satisfacer los requisitos de cumplimiento y seguridad. Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure es una funcionalidad de protección en tiempo real que ayuda a identificar y eliminar virus, spyware y otro software malintencionado, con alertas que se pueden configurar para cuando software malintencionado o no deseado conocido se intente instalar o ejecutar en los sistemas de Azure.

La solución se basa en la misma plataforma antimalware que Microsoft Security Essentials [MSE], Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune y Windows Defender para Windows 8.0 y superior. Microsoft Antimalware para Azure es una solución de un único agente dirigida a entornos de aplicaciones e inquilinos, concebida para ejecutarse en segundo plano sin intervención humana. Puede implementar la protección en función de las necesidades de sus cargas de trabajo de aplicaciones, con configuración de protección básica o personalizada avanzada que incluye supervisión antimalware.

Al implementar y habilitar Microsoft Antimalware para Azure en sus aplicaciones, están disponibles las siguientes características principales:

**Protección en tiempo real**: supervisa la actividad en Servicios en la nube y Máquinas virtuales para detectar y bloquear la ejecución de malware.

**Análisis programado**: realiza periódicamente exámenes dirigidos para detectar malware, lo que incluye programas que se ejecutan activamente.

**Corrección de malware**: actúa automáticamente sobre el malware detectado y elimina o pone en cuarentena los archivos malintencionados y limpia las entradas del Registro malintencionadas.

**Actualizaciones de firmas**: instala automáticamente las últimas firmas de protección (definiciones de virus) para garantizar que la protección está actualizada con una frecuencia determinada previamente.

**Actualizaciones del motor antimalware**: actualiza automáticamente el motor de Microsoft Antimalware.

**Actualizaciones de la plataforma antimalware**: actualiza automáticamente la plataforma de Microsoft Antimalware.

**Protección activa**: envía a Microsoft Azure informes de metadatos de telemetría sobre las amenazas detectadas y los recursos sospechosos para garantizar una respuesta rápida a las amenazas en constante evolución, y para permitir la entrega sincrónica de firmas en tiempo real a través de Microsoft Active Protection System (MAPS).

**Informes de ejemplos**: proporciona informes de ejemplos al servicio Microsoft Antimalware que ayudan a mejorar el servicio y permiten la solución de problemas.

**Exclusiones**: permite a los administradores de aplicaciones y servicios configurar determinados archivos, procesos y unidades para que se excluyan de la protección y el examen por motivos de rendimiento o de otro tipo.

**Recopilación de eventos antimalware**: registra el estado del servicio antimalware, las actividades sospechosas y las acciones de corrección adoptadas en el registro de eventos del sistema operativo y los recopila en la cuenta de almacenamiento de Azure del cliente.

##Arquitectura

La solución Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure incluye el Cliente y servicio de Microsoft Antimalware, la extensión Administración del servicio Antimalware, los cmdlets de PowerShell para Antimalware y la extensión Diagnósticos de Azure. Esta solución es compatible con las familias de sistemas operativos Windows Server 2008 R2, Windows Server 2012 y Windows Server 2012 R2. No se admite en el sistema operativo Windows Server 2008. En este momento, no se admite Windows Server Technical Preview pero tenemos previsto admitirla en el futuro.

El Cliente y servicio de Microsoft Antimalware se instala de forma predeterminada en un estado deshabilitado en todas las familias de sistemas operativos invitados compatibles con Azure en la plataforma de Servicios en la nube.

El Cliente y servicio de Microsoft Antimalware no se instala de forma predeterminada en la plataforma de Máquinas virtuales, si no que está disponible como una característica opcional en el Portal de administración de Azure y en la configuración de máquinas virtuales de Visual Studio en Extensiones de seguridad.

###Flujo de trabajo de Microsoft Antimalware

El administrador de servicios de Azure puede habilitar Antimalware para Azure con una configuración predeterminada o personalizada para Máquinas virtuales y Servicios en la nube mediante las siguientes opciones:

-   Máquinas virtuales: en el Portal de administración de Azure, en Extensiones de seguridad

-   Máquinas virtuales: mediante la configuración de máquinas virtuales de Visual Studio en el Explorador de servidores

-   Máquinas virtuales y Servicios en la nube: mediante las API de administración de servicios Antimalware (SMAPI)

-   Máquinas virtuales y Servicios en la nube: mediante los cmdlets de PowerShell para Antimalware

El Portal de administración de Azure o los cmdlets de PowerShell insertan el archivo del paquete de extensiones de Antimalware en el sistema de Azure en una ubicación fija predeterminada. El agente invitado de Azure (o el agente de tejido) inicia la extensión de Antimalware y aplicar los valores de configuración de Antimalware proporcionados como entrada. Este paso habilita el servicio Antimalware con valores de configuración predeterminados o personalizados. Si no se proporciona ninguna configuración personalizada, el servicio Antimalware se habilita con la configuración predeterminada. Consulte la sección *Configuración Antimalware* de [Ejemplos de código de Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure](http://aka.ms/amazsamples "Ejemplos de código de Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure") para obtener más detalles.

Una vez en ejecución, el cliente de Microsoft Antimalware descarga de Internet las definiciones más recientes de firmas y del motor de protección y las carga en el sistema de Azure. El servicio Microsoft Antimalware escribe eventos relacionados con el servicio en el registro de eventos del SO del sistema, en el origen del evento "Microsoft Antimalware". Los eventos incluyen, entre otros, el estado de mantenimiento, protección y corrección del cliente Antimalware, valores de configuración nuevos y antiguos, actualizaciones del motor y definiciones de firmas.

Puede habilitar la supervisión Antimalware para que en el servicio en la nube o la máquina virtual se escriban los eventos del registro de eventos Antimalware a medida que se generan en la cuenta de almacenamiento de Azure. El servicio Antimalware usa la extensión Diagnósticos de Azure para recopilar eventos Antimalware del sistema de Azure en tablas de la cuenta de almacenamiento de Azure del cliente.

El flujo de trabajo de implementación, que incluye pasos de configuración y opciones admitidas para los escenarios anteriores, se documenta en la sección [Escenarios de implementación de Antimalware](#_Antimalware_Deployment_Scenarios) de este documento.

![Microsoft Antimalware en Azure](./media/azure-security-antimalware/sec-azantimal-fig1.PNG)

###Configuración predeterminada y personalizada de Antimalware

Si no se proporcionan valores de configuración personalizados, se aplican los valores de configuración predeterminados para habilitar Antimalware para Servicios en la nube o Máquinas virtuales de Azure. Los valores de configuración predeterminados se han optimizado previamente para ejecutarse en el entorno de Azure. Opcionalmente, puede personalizar estos valores de configuración predeterminados para adaptarlos a la implementación de su aplicación o servicio de Azure y aplicarlos en otros escenarios de implementación.

En la tabla siguiente se resumen las opciones de configuración disponibles para el servicio Antimalware. La configuración predeterminada se marca en la columna "Predeterminada" que se muestra a continuación.

![Tabla 1](./media/azure-security-antimalware/sec-azantimal-tb18.PNG)

##Escenarios de implementación de Antimalware

Los escenarios para habilitar y configurar Antimalware, incluida la supervisión de Servicios en la nube y Máquinas virtuales de Azure, se tratan en esta sección.

###Máquinas virtuales: habilitación y configuración de Antimalware

**Implementación con el Portal de vista previa de Azure**

Para habilitar el servicio Antimalware, haga clic en **Agregar** en la hoja Extensiones, seleccione **Microsoft Antimalware** en la hoja Nuevo recurso y haga clic en **Crear** en la hoja Microsoft Antimalware. Haga clic en **Crear** sin especificar los valores de configuración para habilitar Antimalware con la configuración predeterminada, o especifique la configuración Antimalware de la máquina virtual configurada, como se muestra en la ilustración 2. Consulte la **información sobre herramientas** que se proporciona con cada valor de configuración en la hoja Agregar extensión para ver los valores de configuración admitidos.

![Configuración de los valores de máquina virtual para Microsoft Antimalware](./media/azure-security-antimalware/sec-azantimal-fig2.PNG)

**Implementación con el Portal de administración de Azure**

Para habilitar y configurar Microsoft Antimalware en Máquinas virtuales de Azure mediante el Portal de administración de Azure mientras aprovisiona una máquina virtual, siga estos pasos:

1\. Inicie sesión en el Portal de administración de Azure en <https://manage.windowsazure.com>

2\. Para crear una nueva máquina virtual, haga clic en **Nuevo**, **Proceso**, **Máquina** **virtual**, **Desde la galería** (no use Creación rápida), como se muestra a continuación:

![Nueva máquina virtual](./media/azure-security-antimalware/sec-azantimal-fig3.PNG)


3\. Seleccione la imagen **Microsoft Windows Server** en la página **Elegir una imagen**.

4\. Haga clic en la flecha derecha y especifique la configuración de la máquina virtual.

5\. Active la casilla **Microsoft Antimalware** en **Extensiones de seguridad** en la página de configuración de máquinas virtuales.

6\. Haga clic en el botón Enviar para habilitar y configurar Microsoft Antimalware en Máquinas virtuales de Azure con la configuración predeterminada.

![Configuración de máquina virtual](./media/azure-security-antimalware/sec-azantimal-fig4.PNG)

**Implementación mediante la configuración de máquinas virtuales de Visual Studio**

Para habilitar y configurar el servicio Microsoft Antimalware con Visual Studio:

1\. Conéctese a Microsoft Azure en Visual Studio.

2\. Elija su máquina virtual en el nodo **Máquinas virtuales** del **Explorador de servidores**

![Configuración de máquina virtual en Visual Studio](./media/azure-security-antimalware/sec-azantimal-fig5.PNG)

3\. Haga clic con el botón derecho en **configurar** para ver la página de configuración de máquinas virtuales.

4\. Seleccione la extensión **Microsoft Antimalware** en la lista desplegable bajo **Extensiones instaladas** y haga clic en **Agregar** para realizar la configuración predeterminada de Antimalware.

![Extensiones instaladas](./media/azure-security-antimalware/sec-azantimal-fig6.PNG)

5\. Para personalizar la configuración predeterminada de Antimalware, seleccione (resalte) la extensión Antimalware en la lista de extensiones instaladas y haga clic en **Configurar**.

6\. Reemplace la configuración predeterminada de Antimalware por la configuración personalizada en formato JSON admitido en el cuadro de texto **Configuración pública** y haga clic en Aceptar.

7\. Haga clic en el botón **Actualizar** para insertar las actualizaciones de configuración en la máquina virtual.

![Extensión de configuración de máquina virtual](./media/azure-security-antimalware/sec-azantimal-fig7.PNG)

**Nota:** la configuración de Máquinas virtuales de Visual Studio para Antimalware solo admite el formato JSON. La plantilla de configuración JSON de Antimalware se incluye en los [Ejemplos de código de Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure](http://aka.ms/amazsamples "Ejemplos de código de Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure"), que muestra los valores de configuración de Antimalware admitidos.

**Implementación mediante cmdlets de PowerShell**

Una aplicación o un servicio de Azure puede habilitar y configurar Microsoft Antimalware para Máquinas virtuales de Azure mediante cmdlets de PowerShell.

Para habilitar y configurar Microsoft Antimalware con cmdlets de PowerShell:

1. Configure el entorno de PowerShell; consulte para ello la documentación que se muestra en <https://github.com/Azure/azure-sdk-tools#get-started>.

2. Use el cmdlet de Antimalware Set-AzureVMMicrosoftAntimalwareExtension para habilitar y configurar Microsoft Antimalware para su Máquina virtual, como se documenta en <http://msdn.microsoft.com/library/azure/dn771718.aspx>.

**Nota:** la configuración de Máquinas virtuales de Azure para Antimalware solo admite el formato JSON. La plantilla de configuración JSON de Antimalware se incluye en los [Ejemplos de código de Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure](http://aka.ms/amazsamples "Ejemplos de código de Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure"), que muestra los valores de configuración de Antimalware admitidos.

###Habilitación y configuración de Antimalware mediante cmdlets de PowerShell

Una aplicación o un servicio de Azure puede habilitar y configurar Microsoft Antimalware para Servicios en la nube de Azure mediante cmdlets de PowerShell. Tenga en cuenta que Microsoft Antimalware se instala con un estado deshabilitado en la plataforma de Servicios en la nube y requiere la acción de una aplicación de Azure para habilitarlo.

Para habilitar y configurar Microsoft Antimalware mediante cmdlets de PowerShell:

1.  Configure el entorno de PowerShell; consulte para ello la documentación que se muestra en <https://github.com/Azure/azure-sdk-tools#get-started>.

2.  Use el cmdlet de Antimalware Set-AzureServiceAntimalwareExtension para habilitar y configurar Microsoft Antimalware para su Servicio en la nube, como se documenta en <http://msdn.microsoft.com/library/azure/dn771718.aspx>.

La plantilla de configuración JSON de Antimalware se incluye en los [Ejemplos de código de Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure](http://aka.ms/amazsamples "Ejemplos de código de Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure"), que muestra los valores de configuración de Antimalware admitidos.

###Servicios en la nube y Máquinas virtuales: configuración mediante cmdlets de PowerShell

Una aplicación o un servicio de Azure puede recuperar la configuración de Microsoft Antimalware para Servicios en la nube y Máquinas virtuales mediante cmdlets de PowerShell.

Para recuperar la configuración de Microsoft Antimalware mediante cmdlets de PowerShell:

1.  Configure el entorno de PowerShell; consulte para ello la documentación que se muestra en <https://github.com/Azure/azure-sdk-tools#get-started>.

2.  **Para Máquinas virtuales**: use el cmdlet de Antimalware Get-AzureVMMicrosoftAntimalwareExtension para obtener la configuración de antimalware, como se documenta en <http://msdn.microsoft.com/library/azure/dn771719.aspx>.

3.  **Para Servicios en la nube**: use el cmdlet de Antimalware Get-AzureServiceAntimalwareConfig para obtener la configuración de antimalware, como se documenta en <http://msdn.microsoft.com/library/azure/dn771722.aspx>.

###Eliminación de la configuración de Antimalware mediante cmdlets de PowerShell

Una aplicación o un servicio de Azure puede quitar la configuración Antimalware, y cualquier configuración de supervisión de Antimalware asociada, de las extensiones pertinentes del servicio de diagnóstico y del servicio Antimalware de Azure asociadas al servicio en la nube o la máquina virtual.

Para quitar Microsoft Antimalware mediante cmdlets de PowerShell:

1.  Configure el entorno de PowerShell; consulte para ello la documentación que se muestra en <https://github.com/Azure/azure-sdk-tools#get-started>.

2.  **Para Máquinas virtuales**: use el cmdlet de Antimalware Remove-AzureVMMicrosoftAntimalwareExtension, como se documenta en <http://msdn.microsoft.com/library/azure/dn771720.aspx>.

3.  **Para Servicios en la nube:** use el cmdlet de Antimalware Remove-AzureServiceAntimalwareExtension, como se documenta en <http://msdn.microsoft.com/library/azure/dn771717.aspx>.

Para **habilitar** la recopilación de eventos de Antimalware de una máquina virtual mediante el Portal de vista previa de Azure:

1.  Haga clic en cualquier parte de la lente Supervisión en la hoja Máquina Virtual.

2.  Haga clic en el comando Diagnóstico en la hoja Métrica.

3.  Seleccione **Estado** activado y marque la opción para los registros del sistema de eventos de Windows. Puede desactivar todas las demás opciones de la lista o dejarlas habilitadas, según las necesidades de su servicio de aplicación.

4.  Las categorías de eventos Antimalware "Error", "Advertencia", "Informativo", etc., se capturan en la cuenta de almacenamiento de Azure.

Los eventos Antimalware se recopilan de los registros del sistema de eventos de Windows y se colocan en la cuenta de almacenamiento de Azure. Puede configurar la cuenta de almacenamiento de la máquina virtual para la recopilación de eventos Antimalware seleccionando la cuenta de almacenamiento adecuada.

![Métricas y diagnósticos](./media/azure-security-antimalware/sec-azantimal-fig8.PNG)

###Habilitación y configuración de la supervisión Antimalware mediante cmdlets de PowerShell

Puede habilitar la recopilación de eventos de Microsoft Antimalware para su servicio en la nube o máquina virtual usando Diagnósticos de Azure con cmdlets de PowerShell para Antimalware. La extensión Diagnósticos de Azure puede configurarse para capturar eventos del origen de registro de eventos del sistema "Microsoft Antimalware" y colocarlos en su cuenta de almacenamiento de Azure. Las categorías de eventos Antimalware "Error", "Advertencia", "Informativo", etc., se capturan en la cuenta de almacenamiento de Azure.

Para habilitar la recopilación de eventos Antimalware en su cuenta de almacenamiento de Azure mediante cmdlets de PowerShell:

1.  Configure el entorno de PowerShell; para ello, consulte la documentación que aparece en <https://github.com/Azure/azure-sdk-tools#get-started>.

2.  **Para Máquinas virtuales**: use el cmdlet de Antimalware Set-AzureVMMicrosoftAntimalwareExtension con la opción de supervisión activada, como se documenta en <http://msdn.microsoft.com/library/azure/dn771716.aspx>.

3.  **Para Servicios en la nube**: use el cmdlet de Antimalware Set-AzureServiceAntimalwareExtension con la opción de supervisión activada, como se documenta en <http://msdn.microsoft.com/library/azure/dn771718.aspx>.

Puede ver los eventos sin procesar Antimalware si examina la tabla WADWindowsEventLogsTable de la cuenta de almacenamiento de Azure que configuró para habilitar la supervisión Antimalware. Esto puede ser útil para validar que la recopilación de eventos Antimalware funciona y para conocer el estado del servicio Antimalware. Para obtener más detalles, como el código de ejemplo sobre cómo extraer eventos Antimalware de la cuenta de almacenamiento, consulte [Ejemplos de código de Microsoft Antimalware para Servicios en la nube y Máquina virtuales de Azure](http://aka.ms/amazsamples "Ejemplos de código de Microsoft Antimalware para Servicios en la nube y Máquinas virtuales de Azure").

<!---HONumber=AcomDC_1217_2015-->