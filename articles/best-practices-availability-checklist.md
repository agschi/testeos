<properties
   pageTitle="Lista de comprobación de disponibilidad | Microsoft Azure"
   description="Lista de comprobación que ofrece una guía para las inquietudes sobre disponibilidad durante el diseño."
   services=""
   documentationCenter="na"
   authors="dragon119"
   manager="masimms"
   editor=""
   tags=""/>

<tags
   ms.service="best-practice"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="12/15/2015"
   ms.author="masashin"/>

# Lista de comprobación de disponibilidad

![](media/best-practices-availability-checklist/pnp-logo.png)

## Diseño de aplicación

- **Evitar los puntos únicos de error.** Todos los componentes, servicios, recursos e instancias de procesos deben implementarse como varias instancias para impedir que un único punto de error afecte a la disponibilidad. Esto incluye mecanismos de autenticación. Diseñe la aplicación para que se configure para usar varias instancias y para detectar errores automáticamente y redirigir las solicitudes a instancias sin errores donde la plataforma no lo hace automáticamente.
- **Descomponer la carga de trabajo por SLA diferente.** Si un servicio se compone de cargas de trabajo críticas y menos críticas, adminístrelos de manera diferente y especifique las características de servicio y el número de instancias para satisfacer sus requisitos de disponibilidad.
- **Minimizar y comprender las dependencias de servicio.** Minimice el número de servicios diferentes que se usan siempre que sea posible y asegúrese de que comprende todas las dependencias de características y servicios que existen en el sistema. Esto incluye la naturaleza de estas dependencias y el impacto del error o la reducción del rendimiento de cada una de ellas en la aplicación general. Microsoft garantiza el 99,9 % de disponibilidad como mínimo para la mayoría de los servicios, pero esto significa que cada servicio adicional en el que se basa una aplicación reduce potencialmente el SLA de disponibilidad general de su sistema en un 0,1 %.
- **Diseñar tareas y mensajes para que sean idempotentes siempre que sea posible** de manera que las solicitudes duplicadas no causen problemas. Por ejemplo, un servicio puede actuar como un consumidor que administra los mensajes enviados como solicitudes por otras partes del sistema que actúan como productores. Si se produce un error en el consumidor tras el procesamiento del mensaje, pero antes de confirmar que se ha procesado, un productor podría enviar una solicitud de repetición que podría ser controlada por otra instancia del consumidor. Por este motivo, los consumidores y las operaciones que se llevan a cabo deben ser idempotentes para que la repetición de una operación ejecutada anteriormente no represente los resultados no válidos. Esto puede significar la detección de mensajes duplicados o garantizar la coherencia mediante un enfoque optimista para tratar los conflictos.
- **Usar un agente de mensajes que implementa alta disponibilidad para las transacciones críticas.** Muchos escenarios para iniciar tareas o acceder a servicios remotos usan mensajería para pasar instrucciones entre la aplicación y el servicio de destino. Para obtener el mejor rendimiento, la aplicación debe ser capaz de enviar el mensaje y, a continuación, volver a procesar más solicitudes sin necesidad de esperar una respuesta. Para garantizar la entrega de mensajes, el sistema de mensajería debe proporcionar una alta disponibilidad. Las colas de mensajes del bus de servicio implementan semántica de _al menos una vez_, mediante la cual no se perderá cada mensaje enviado a una cola, aunque se pueden entregar copias duplicadas en determinadas circunstancias. Si el procesamiento de mensajes es idempotente (vea el elemento anterior), la entrega repetida no debería ser un problema.
- **Diseñar aplicaciones para degradar de forma correcta** al alcanzar límites de recursos y realizar una acción apropiada para minimizar el impacto para el usuario. En algunos caso, la carga en la aplicación puede superar la capacidad de una o más partes, haciendo que se reduzca la disponibilidad y que se produzcan errores en las conexiones. El ajuste de escala puede ayudar a aliviar esto pero puede alcanzar un límite impuesto por factores como el coste o la disponibilidad de recursos. Diseñe la aplicación para que, en esta situación, puede degradar de manera automática y correcta. Por ejemplo, en un sistema de comercio electrónico, si el subsistema de procesamiento de pedidos está bajo presión (o incluso ha fallado por completo), esa parte del sistema se puede deshabilitar temporalmente mientras que permite que continúen otras funciones (por ejemplo, la exploración del catálogo de productos). Podría ser adecuado posponer las solicitudes a un subsistema con error, por ejemplo, habilitando todavía a los clientes para enviar pedidos aunque guardándolos en una cola u otro mecanismo de almacenamiento seguro para su procesamiento posterior cuando el subsistema de pedidos esté disponible de nuevo.
- **Administrar correctamente los eventos rápidos de ráfaga.** La mayoría de las aplicaciones necesitan controlar diferentes cargas de trabajo con el tiempo, por ejemplo, los picos a primera hora de la mañana en una aplicación empresarial o cuando se lanza un producto nuevo en un sitio de comercio electrónico. El ajuste de escala automático puede ayudar a controlar la carga, pero se puede tardar algún tiempo en que las instancias adicionales entren en línea y controlen las solicitudes. Impida que las ráfagas repentinas e inesperadas sobrecarguen la aplicación mediante su diseño para poner en cola las solicitudes para los servicios que usa y para degradar correctamente cuando las colas están cerca de la capacidad completa. Asegúrese de que hay suficiente capacidad y rendimiento disponibles en condiciones sin ráfaga para descargar las colas y controlar las solicitudes pendientes. Para obtener más información, vea el [modelo de nivelación de carga basado en cola](https://msdn.microsoft.com/library/dn589783.aspx).

## Implementación y mantenimiento

- **Implementar varias instancias de roles para cada servicio.** Microsoft ofrece garantías de disponibilidad para los servicios que crea e implementa, pero estas garantías solo son válidas si implementa al menos dos instancias de cada rol en el servicio. Esto permite que un rol no esté disponible mientras el otro permanece activo. Esto es especialmente importante si necesita implementar actualizaciones en un sistema activo sin interrumpir las actividades de los clientes; las instancias se pueden desactivar y actualizar individualmente mientras las demás continúan en línea.
- **Hospedar aplicaciones en varios centros de datos.** A pesar de ser muy improbable, es posible que un centro de datos completo pase a estar desconectado a través de un evento como un desastre natural o un error de Internet de tronco. Las aplicaciones empresariales vitales deben estar hospedadas en más de un centro de datos para proporcionar la máxima disponibilidad. Esto tiene una ventaja añadida en el sentido de que puede reducir la latencia para los usuarios locales y ofrece más oportunidades de flexibilidad al actualizar las aplicaciones.
- **Automatizar y probar las tareas de implementación y mantenimiento.** Las aplicaciones distribuidas constan de varias partes que deben funcionar en conjunto. Por tanto, la implementación debe estar automatizada con mecanismos probados, como scripts y aplicaciones de implementación que actualizan y validan la configuración y automatizar el proceso de implementación. También deben usarse técnicas automatizadas para realizar actualizaciones de todas las aplicaciones o de partes de ellas. Es fundamental probar todos estos procesos por completo para asegurarse de que los errores no provocan tiempo de inactividad adicional. Todas las herramientas de implementación deben tener restricciones de seguridad adecuados para proteger la aplicación implementada; defina y aplique directivas de implementación con cuidado y minimice la necesidad de la intervención humana.
- **Considere el uso de las características de ensayo y producción de la plataforma** donde están disponibles. Por ejemplo, con los entornos de ensayo y producción de los Servicios en la nube de Azure las aplicaciones pueden pasar de una a otra al instante a través de un intercambio de direcciones IP virtuales (VIP de intercambio). Sin embargo, si prefiere colocar en ensayo un entorno local, o implementar versiones diferentes de la aplicación al mismo tiempo y migrar gradualmente los usuarios, es posible que no pueda usar una operación de intercambio de VIP.
- **Aplicar cambios en la configuración sin reciclar** la instancia cuando sea posible. En muchos casos, los valores de configuración para un servicio o una aplicación de Azure se pueden cambiar sin necesidad de que se reinicie el rol. Los eventos de exposición de rol que se pueden controlar para detectar los cambios de configuración y aplicarlos a los componentes dentro de la aplicación. Sin embargo, algunos cambios a la configuración de la plataforma de núcleo requerirán que se reinicie un rol. Al crear componentes y servicios, maximice la disponibilidad y minimice el tiempo de inactividad, diseñándolos para aceptar los cambios a los valores de configuración sin necesidad de que se reinicie la aplicación en su conjunto.
- **Usar dominios de actualización para tiempo de inactividad cero durante las actualizaciones.** Las unidades de proceso de Azure, como roles web y de trabajo, se asignan para actualizar dominios. Actualice instancias de rol de grupo de dominios en conjunto para que, cuando se realice una actualización gradual, se detenga cada rol del dominio de actualización, se detenga, se actualice y se reinicie a su vez con el fin de minimizar el impacto en la disponibilidad de la aplicación. Puede especificar cuántos dominios de actualización se deben crear para un servicio cuando se implementa el servicio.

	> [AZURE.NOTE] Los roles también se distribuyen en dominios de error, cada uno de los cuales es razonablemente independiente de otros dominios con error en cuanto al bastidor del servidor, la energía y la provisión de refrigeración, con el fin de minimizar la posibilidad de que un error afecte a todas las instancias de rol. Esta distribución se produce automáticamente y no se puede controlar.

- **Configurar conjuntos de disponibilidad para máquinas virtuales de Azure.** La colocación de dos o más máquinas virtuales en el mismo conjunto de disponibilidad garantiza que estas máquinas virtuales no se implementarán en el mismo dominio de error. Para maximizar la disponibilidad, debe crear varias instancias de cada máquina virtual crítica usada por el sistema y colocar estas instancias en el mismo conjunto de disponibilidad. Si ejecuta varias máquinas virtuales que se usan con otros fines, cree un conjunto de disponibilidad para cada máquina virtual y agregue instancias de cada máquina virtual a cada conjunto de disponibilidad. Por ejemplo, si ha creado máquinas virtuales independientes para que actúen como servidor web y servidor de informes, cree un conjunto de disponibilidad para el servidor web y otro conjunto de disponibilidad para el servidor de informes. Agregue instancias de la máquina virtual del servidor web al conjunto de disponibilidad del servidor web, y agregue instancias de la máquina virtual del servidor de informes al conjunto de disponibilidad de servidor de informes.

## Administración de datos

- **Aprovechar las ventajas de la replicación de datos** mediante la redundancia local y geográfica. Los datos en el almacenamiento de Azure se replican automáticamente para proteger frente a la pérdida en caso de error de infraestructura, y se pueden configurar algunos factores de esta réplica. Por ejemplo, las copias de solo lectura de los datos pueden replicarse en más de una región geográfica (denominada almacenamiento redundante globalmente de acceso de lectura o RA-GRS). Tenga en cuenta que el uso de RA-GRS incurre en gastos adicionales; vea la página de [Precios de almacenamiento de Azure](https://azure.microsoft.com/pricing/details/storage/) del sitio web de Microsoft para obtener más información.
- **Usar simultaneidad optimista y coherencia eventual** siempre que sea posible. Las transacciones que bloquean el acceso a recursos a través del bloqueo (concurrencia pesimista) pueden producir un bajo rendimiento y reducir considerablemente la disponibilidad. Estos problemas pueden ser especialmente importantes en sistemas distribuidos. En muchos casos, las técnicas y un diseño cuidadoso como la creación de particiones pueden minimizar las posibilidades de que se produzcan actualizaciones que generan conflictos. En los casos donde se replican los datos o se leen desde un almacén actualizado por separado, los datos solo serán coherentes con el tiempo, pero las ventajas normalmente superarán con creces el impacto en la disponibilidad del uso de las transacciones para garantizar la coherencia inmediata.
- **Usar copias de seguridad periódicas y restauración a un momento dado** y asegurarse de que cumple el objetivo de punto de recuperación (RPO). Realice copias de seguridad de datos regulares y automáticas que no se conserven en otra parte y compruebe que puede restaurar con confiabilidad tanto los datos como la propia aplicación en el que caso de que produzca un error. La replicación de datos no es una característica de copia de seguridad porque los errores e incoherencias introducidas por un error u operaciones malintencionadas se replicarán en todos los almacenes. El proceso de copia de seguridad debe ser seguro para proteger los datos en tránsito y en almacenamiento. Las bases de datos o las partes de un almacén de datos se pueden recuperar normalmente para un momento anterior en el tiempo mediante registros de transacciones. Microsoft Azure ofrece una utilidad de copia de seguridad para los datos almacenados en la Base de datos SQL de Microsoft Azure. Los datos se exportan a un paquete de copia de seguridad en el almacenamiento de blobs de Microsoft Azure y se pueden descargar en una ubicación local segura para almacenamiento.
- **Habilitar la opción de alta disponibilidad para mantener una copia secundaria de una caché de Redis.** Al usar la caché de Redis, elija la opción Estándar para mantener una copia secundaria del contenido. Para obtener más información, vea la página [Crear una caché en la Caché en Redis de Azure](https://msdn.microsoft.com/library/dn690516.aspx) en el sitio web de Microsoft.

## Errores

- **Presentar el concepto de un tiempo de espera.** Puede que los servicios y recursos dejen de estar disponibles, provocando errores en las solicitudes. Asegúrese de que los tiempos de espera que aplica son adecuados para cada servicio o recurso, además del cliente que accede a ellos (en algunos casos, puede que sea adecuado permitir un tiempo de espera más largo para una instancia determinada de un cliente, según el contexto y las demás acciones que realiza el cliente). Los tiempos de espera muy breves pueden provocar operaciones de reintento excesivas para servicios y recursos que tienen una latencia considerable, pero tiempos de espera muy largos pueden causar bloqueos si se ponen en cola un gran número de solicitudes en espera de que responda un servicio o recurso.
- **Reintentar las operaciones con errores causadas por errores transitorios.** Diseñe una estrategia de reintento para acceder a todos los servicios y recursos donde no admiten de manera inherente el reintento de conexión automática. Use una estrategia que incluye un retraso creciente entre reintentos conforme aumenta el número de errores para evitar la sobrecarga del recurso y para permitirle que recupere y controle de forma correcta las solicitudes en cola. Los reintentos continuos con retrasos muy breves suelen agravar el problema.
- **Detener el envío de solicitudes para evitar los errores en cascada** cuando los servicios remotos no estén disponibles. Puede haber situaciones en las que errores transitorios o de otro tipo, con una gravedad que abarca desde una pérdida parcial de la conectividad hasta el error completo de un servicio, tardan mucho más tiempo del esperado en volver a su estado normal. Además, si un servicio está muy ocupado, el error en una parte del sistema puede provocar errores en cascada y hacer que se bloqueen muchas operaciones mientras se retienen en recursos críticos del sistema como la memoria, los subprocesos y las conexiones de base de datos. En lugar de reintentar continuamente una operación que es improbable que tenga éxito, la aplicación debería aceptar rápidamente que la operación ha generado error y tratar correctamente este error. Puede usar el patrón del Interruptor para rechazar solicitudes para operaciones específicas para períodos definidos. La página [Patrón de disyuntor](https://msdn.microsoft.com/library/dn589784.aspx) del sitio web de Microsoft ofrece más detalles.
- **Componer o revertir a múltiples componentes** para mitigar el impacto de que un servicio específico esté desconectado o no disponible. Diseñe aplicaciones para sacar provecho de varias instancias sin que se vea afectada la operación y las conexiones existentes donde sea posible. Con el fin de maximizar la disponibilidad, use varias instancias y distribuya las solicitudes entre ellas, y detecte y evite el envío de solicitudes a instancias con error.
- **Revertir a un flujo de trabajo o servicio diferente** siempre que sea posible. Por ejemplo, si se produce un error al escribir en la base de datos SQL, almacene datos temporalmente en el almacenamiento de blobs y proporcione una instalación para reproducir las escrituras en el almacenamiento de blobs para la base de datos SQL cuando el servicio esté disponible. En algunos casos, una operación con error puede tener una acción alternativa que permite que la aplicación continúe trabajando incluso cuando un componente o un servicio produce un error. Si es posible, detecte errores y redirija solicitudes a otros servicios que puedan ofrecer una funcionalidad alternativa adecuada, o para realizar una copia o reducir las instancias de funcionalidad que pueden mantener operaciones principales mientras el servicio principal está desconectado.

## Supervisión y recuperación ante desastres

- **Proporcionar instrumentación enriquecida para errores probables y eventos de error** para notificar la situación al personal de operaciones. Para los errores que son probables pero que no se han producido todavía, ofrezca datos suficientes para habilitar al personal de operaciones para determinar la causa, mitigar la situación y garantizar que el sistema sigue disponible. Para los errores que ya se han producido, la aplicación debe devolver un mensaje de error adecuado al usuario pero intentará continuar ejecutándose, aunque con funcionalidad reducida. En todos los casos, el sistema de supervisión debe capturar información completa para permitir que el personal de operaciones lleve a cabo una recuperación rápida y, en caso necesario, para que los diseñadores y desarrolladores modifiquen el sistema a fin de evitar que la situación se produzca de nuevo.
- **Supervisar el estado del sistema mediante la implementación de funciones de comprobación.** El estado y el rendimiento de una aplicación pueden reducirse con el tiempo sin que sea apreciable hasta que se produce un error. Una manera de protegerse contra esto es implementar sondeos o funciones de comprobación que se ejecutan con regularidad desde fuera de la aplicación. Estas comprobaciones pueden ser tan simples como la medición del tiempo de respuesta para la aplicación en su conjunto, para las partes individuales de la aplicación, para los servicios individuales que usa la aplicación o para los componentes individuales. Las funciones de comprobación pueden ejecutar procesos para garantizar que producen resultados válidos, para medir la latencia y comprobar la disponibilidad, y para extraer la información del sistema.
- **Probar con regularidad todos los sistemas de conmutación por error y reserva** para asegurarse de que están disponibles y de que funcionan según lo previsto. Los cambios realizados a los sistemas y las operaciones pueden afectar a las funciones de reserva y de conmutación por error, pero es posible que no se detecte el impacto hasta que el sistema principal genere un error o se sobrecargue. Es recomendable probarlo antes de que sea necesario compensar para un problema en directo en tiempo de ejecución.
- **Probar los sistemas de supervisión.** Los sistemas automatizados de conmutación por error y de reserva, así como la visualización manual del rendimiento y el mantenimiento del sistema mediante el uso de paneles, dependen del funcionamiento correcto de la supervisión y la instrumentación. Si estos elementos generan un error, pierden información fundamental o informan de datos imprecisos, es posible que un operador no se dé cuenta de que el sistema es incorrecto o de que tiene errores.
- **Realizar un seguimiento del progreso de los flujos de trabajo de larga ejecución** y volver a intentarlo en caso de error. Los flujos de trabajo de larga ejecución suelen constar de varios pasos. Al diseñar estos tipos de flujos de trabajo, asegúrese de que cada paso es independiente y de que se puede volver a intentar para minimizar la posibilidad de que se tenga que revertir todo el flujo de trabajo o de que se tengan que ejecutar varias transacciones de compensación. Supervise y administre el progreso de los flujos de trabajo de larga ejecución implementando un patrón como el supervisor del agente del programador. Para obtener más información, vea la página del [patrón del supervisor del agente del programador](https://msdn.microsoft.com/library/dn589780.aspx) en el sitio web de Microsoft.
- **Planear la recuperación ante desastres.** Asegúrese de que hay un plan acordado, documentado y completamente probado para la recuperación antes cualquier tipo de error que puede hacer que todo el sistema principal, o parte del mismo, deje de estar disponible. Probar los procedimientos con regularidad y asegúrese de que todo el personal de operaciones está familiarizado con el proceso.

<!---HONumber=AcomDC_0128_2016-->